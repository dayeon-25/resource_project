<div class="modal" id="modal">
    <div class="modal-container">
        <span class="modal-close" id="modal-close">&times;</span>

        {{#result}}
            <p class="analysis-date">분석일자 {{analysisDate}}</p>
            <hr class="modal-line">
            <div class="analysis-container">
                <div class="analysis-content1">
                    <div class="content1-left">
                        <h1 class="modal-title">순환골재 품질 분석 리포트</h1>
                        <p style="font-size:0.7rem;">AI기반 불순물 검출 및 품질 기준 적합성 판단 결과</p>

                        <div class="analysis-result-title">
                            <h2>분석 결과<span>R-CNN을 메인으로,PCA 색상 분석은 보조 지표로 활용</span></h2>
                            <p>기준 : KS F2576</p>
                        </div>
                        <hr class="modal-line">
                    </div>

                    <div class="content1-right">
                        <p>입력이미지</p>
                        <img src="{{origImage}}" alt="원본 이미지" class="modal-img">
                    </div>
                </div>

                <div class="analysis-content2">
                    <div class="analysis-box">
                        <h2 class="analysis-title">R-CNN 객체 검출 분석<span>불순물 객체 검출 과정</span></h2>
                        <hr class="modal-line">
                        <img src="{{rcnnResult}}" alt="rcnn 이미지" class="modal-img">
                        <p class="analysis-description">
                            <strong>R-CNN (Region-based Convolutional Neural Network)</strong>은
                            이미지에서 <span class="highlight">객체가 있을 법한 영역(Region Proposal)</span>을 추출하고,
                            각 영역을 CNN으로 분류하여 객체를 인식하는 <strong>딥러닝 기반 객체 탐지 기법</strong>입니다.<br><br>
                            학습된 모델을 이용해 이미지 내 <span class="highlight">불순물 영역</span>을 검출하고,
                            전체 픽셀 대비 불순물 픽셀 비율을 계산하여 품질 적합 여부를 평가합니다.<br>
                            📊 전체 불순물 비율 : <strong>{{total}}%</strong>
                        </p>
                    </div>

                    <div class="analysis-box">
                        <h2 class="analysis-title">OpenCV 분석<span>색상 기반 불순물 검출 과정</span></h2>
                        <hr class="modal-line">
                        <img src="{{opencvResult}}" alt="opencv 이미지" class="modal-img">
                        <p class="analysis-description">
                            <strong>OpenCV 색상 분석</strong>은 이미지의 색상 정보를 <span class="highlight">RGB</span> 형태로 변환한 뒤,
                            특정 색상 범위에 포함되지 않는 영역을 <strong>불순물로 탐지</strong>하는 방법입니다.<br><br>
                            불순물에 해당하는 최적 색상 범위 (<strong>x, x, x</strong>)를 추출하고
                            <span class="highlight">불순물은 흰색</span>, 나머지는 검은색으로 처리하여 시각적으로 구분했습니다.
                        </p>
                    </div>

                    <div class="analysis-box">
                        <h2 class="analysis-title">PCA 분석<span>이상치 검출 과정</span></h2>
                        <hr class="modal-line">
                        <img src="{{pca}}" alt="pca 이미지" class="modal-img">
                        <p class="analysis-description">
                            <strong>PCA (Principal Component Analysis)</strong>는 데이터를 주요 특징(주성분)으로 압축하여
                            다른 영역과 통계적으로 다른 <span class="highlight">이상치</span>를 찾아내는
                            <strong>통계적 차원 축소 기법</strong>입니다.<br><br>
                            차원 축소 후 <span class="highlight">산점도 그래프</span>로 시각화하여
                            불순물의 분포 패턴과 품질 특성을 한눈에 확인할 수 있도록 구성했습니다.
                        </p>
                    </div>
                </div>

                <div class="analysis-content3">
                    <h2>통계 분석</h2>
                    <div class="analysis-chart-container">
                        <div class="chart-box">
                            <h4>종류별 불순물 구성 비율</h4>
                            <div class="chart-size">
                                <canvas id="modal-donut-chart"></canvas>
                            </div>
                        </div>
                        <div class="chart-box">
                            <h4>불순물 검출량 비교</h4>
                            <div class="chart-size">
                                <canvas id="modal-bar-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        {{/result}}

        {{^result}}
            <p>분석 결과가 존재하지 않습니다.</p>
        {{/result}}
    </div>
</div>
